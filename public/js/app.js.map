{"version":3,"sources":["translation.js","main.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"app.js","sourcesContent":["$.extend($.validator.messages, {\n  required: \"Dieses Feld ist ein Pflichtfeld.\",\n  maxlength: $.validator.format(\"Geben Sie bitte maximal {0} Zeichen ein.\"),\n  minlength: $.validator.format(\"Geben Sie bitte mindestens {0} Zeichen ein.\"),\n  rangelength: $.validator.format(\"Geben Sie bitte mindestens {0} und maximal {1} Zeichen ein.\"),\n  email: \"Geben Sie bitte eine gültige E-Mail Adresse ein.\",\n  url: \"Geben Sie bitte eine gültige URL ein.\",\n  date: \"Bitte geben Sie ein gültiges Datum ein.\",\n  number: \"Geben Sie bitte eine Nummer ein.\",\n  digits: \"Geben Sie bitte nur Ziffern ein.\",\n  equalTo: \"Bitte denselben Wert wiederholen.\",\n  range: $.validator.format(\"Geben Sie bitte einen Wert zwischen {0} und {1} ein.\"),\n  max: $.validator.format(\"Geben Sie bitte einen Wert kleiner oder gleich {0} ein.\"),\n  min: $.validator.format(\"Geben Sie bitte einen Wert größer oder gleich {0} ein.\"),\n  creditcard: \"Geben Sie bitte eine gültige Kreditkarten-Nummer ein.\"\n});","$(function() {\n\n  //define mapbox api\n  mapboxgl.accessToken = 'pk.eyJ1IjoibWFnbm9sbyIsImEiOiJuSFdUYkg4In0.5HOykKk0pNP1N3isfPQGTQ';\n\n  //bin solidarisch form/submit oject\n  var newHuman = {\n    name: '',\n    email: '',\n    address: null\n  };\n\n  //setup popup\n  var popup = new mapboxgl.Popup({\n    closeButton: false\n  });\n\n  //setup mapbox gl map\n  var map = new mapboxgl.Map({\n    container: 'wo_map',\n    style: 'mapbox://styles/mapbox/light-v8',\n    center: [16.372801, 48.209272],\n    zoom: 3,\n  });\n\n  //Add zoom and rotation controls to the map.\n  map.addControl(new mapboxgl.Navigation());\n\n  //setup GeoJSONSource from local API\n  var url = '/api/pois/humans';\n  var source = new mapboxgl.GeoJSONSource({\n    data: url\n  });\n\n  //setup marker data for humans from lokal api\n  map.on('style.load', function() {\n    map.addSource('peoples', source);\n    map.addLayer({\n      \"id\": \"humans\",\n      \"interactive\": true,\n      \"type\": \"circle\",\n      \"paint\": {\n        \"circle-color\": '#EB5B27',\n        \"circle-radius\": 3\n      },\n      \"source\": \"peoples\",\n    })\n  });\n\n  //open popup for click on human marker\n  map.on('click', function(e) {\n    map.featuresAt(e.point, {\n      radius: 7.5,\n      includeGeometry: true,\n      layer: 'humans'\n    }, function(err, features) {\n      if (err || !features.length) {\n        popup.remove();\n        return;\n      }\n      var feature = features[0];\n      popup.setLngLat(feature.geometry.coordinates)\n        .setHTML(feature.properties.name)\n        .addTo(map);\n    })\n  });\n\n  //validate and submit solidarisch form\n  $('#solidarisch').validate({\n    submitHandler: function(form) {\n\n      newHuman.name = $('#name').val();\n      newHuman.email = $('#email').val();\n      newHuman.lat = newHuman.address.geometry.coordinates[0];\n      newHuman.lng = newHuman.address.geometry.coordinates[1];\n\n      $('#solidarisch .btn').attr('disabled', true);\n      $.post('/api/pois/humans', newHuman, function(response) {\n        swal({\n          title: \"Baam!\",\n          text: \"Dein Pin wurde auf die Karte gesetzt!\",\n          type: \"success\",\n          confirmButtonText: \"Ok!\",\n          confirmButtonColor: \"#EB5B27\"\n        });\n        resetMarker();\n        source.setData(url);\n        $('#solidarisch')[0].reset();\n      })\n    }\n  });\n\n  //autocomplete address input with mapzen remote\n  $('#location').autocomplete({\n    serviceUrl: 'https://search.mapzen.com/v1/search',\n    dataType: 'json',\n    paramName: 'text',\n    params: {\n      \"api_key\": \"search-Jssufg0\"\n    },\n    minChars: 3,\n    transformResult: function(response) {\n      return {\n        suggestions: $.map(response.features, function(item) {\n          return {\n            value: item.properties.label,\n            data: item\n          }\n        })\n      }\n    },\n    onSelect: function(suggestion) {\n      newHuman.address = suggestion.data;\n\n      //TODO: When rest of form is valid\n      $('#solidarisch .btn').removeAttr('disabled');\n\n      addMarker(suggestion.data);\n      fly(suggestion.data.geometry.coordinates)\n    }\n  });\n\n  //remove the user marker if present\n  function resetMarker() {\n    var lSource = map.getSource('newMarker');\n    if (typeof lSource != \"undefined\") {\n      map.removeLayer('newEntry');\n      map.removeSource('newMarker')\n    }\n  }\n\n  //add a marker from geo feature\n  function addMarker(data) {\n    resetMarker();\n    map.addSource('newMarker', {\n      type: 'geojson',\n      data: data\n    });\n    map.addLayer({\n      \"id\": \"newEntry\",\n      \"interactive\": true,\n      \"type\": \"circle\",\n      \"paint\": {\n        \"circle-color\": '#00ff00',\n        \"circle-radius\": 5,\n        \"circle-radius-transition\": {\n          duration: 40000\n        }\n      },\n      \"source\": \"newMarker\",\n    })\n  }\n\n  //fly the map to [lat, lng] position\n  function fly(coordinates) {\n    map.flyTo({\n      center: coordinates,\n      zoom: 11\n    });\n  }\n\n});"],"sourceRoot":"/source/"}